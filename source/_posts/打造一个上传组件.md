---
title: 打造一个上传组件
date: 2018-11-26 20:48:46
tags: 前端
---

## 图片上传应该知道的知识balabala

关于文件上传，现代的处理方式基本上都靠xmlhttpRequest 2.0提供的通过blob对象上传了。
关于上传原理这块，可以看看这篇文章。

想要上传一个文件可以通过三种方式
1. 用户input控件，
2. 通过拖拽生成的
3. 通过canvas

之后通过fileReader + blob对象发送二进制文件给服务端。

得益于blob对象，可以分片上传。通过分片我们又可以实现断点续传，重传，秒传等效果。

在使用npm上simple-uploader.js封装的vue组件，可以实现分片功能，因为在和后端接口不是是使用http状态码来指定失败与否的，还是需要仔细研究下，定制下。总体来说这个还是很强大的。


归根结底的我们的上传步骤如下：
1. 获取file对象或者数组
2. 通过fileReader + blob对象分片发送
3. 制定好接口逻辑判断每片是否上传成功，制定成功与失败处理逻辑
4. 通知单个文件上传成功
5. 通知整个文件列表上传成功

## 一个图片上传组件应该具备哪些

```js
// ======================================================
// 定义一些常量
let version = '1.0'
let uid = 0

// 定义一些支持的变量 can I use


// 定义默认配置 defaultOptions = {}

// ======================================================
// 定义类
class Uploader {
  constructor(x, y) {
    this.x = x;
    this.y = y;
    this.uid = uid++;
  }

  toString() {
    return '(' + this.x + ', ' + this.y + ')';
  }
}

// 平行注入一些方法mixin, 参考


// ======================================================
// 定义一些静态属性和静态方法
Uploader.version = version;


// ======================================================
// 导出
export defalut Uploader
```
